%
%	Praxisbezug
%

\pagebreak
\section{NIS2 Analysis}

\onehalfspacing

\subsection{Running the CIS Benchmarks}

This is the Experiment

AKS Benchmark 1.7 against AKS v1.32

\subsection{Benchmarks Findings}

Let's inspect the detailed results from the CIS Scans:

% Table generated by Excel2LaTeX from sheet 'LaTeX'
\begin{table}[h]
  \centering
  \caption{CIS Scans Results RKE2 (Excel2LaTeX)}
    \begin{tabular}{| l | l | p{11.6cm} |}
    \hline
    ID & State & Description \\
    \hline\hline
    1.1.1 & Fail  & Ensure that the API server pod specification file permissions are set to 600 or more restrictive \\
    \hline
    1.1.3 & Fail  & Ensure that the controller manager pod specification file permissions are set to 600 or more restrictive \\
    \hline
    1.1.5 & Fail  & Ensure that the scheduler pod specification file permissions are set to 600 or more restrictive \\
    \hline
    1.1.7 & Fail  & Ensure that the etcd pod specification file permissions are set to 600 or more restrictive \\
    \hline
    1.2.17 & Fail  & Ensure that the --audit-log-path argument is set \\
    \hline
    1.2.18 & Fail  & Ensure that the --audit-log-maxage argument is set to 30 or as appropriate \\
    \hline
    1.2.19 & Fail  & Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate \\
    \hline
    3.2.1 & Fail  & Ensure that a minimal audit policy is created \\
    \hline
    1.1.9 & Warn  & Ensure that the Container Network Interface file permissions are set to 600 or more restrictive \\
    \hline
    1.1.20 & Warn  & Ensure that the Kubernetes PKI certificate file permissions are set to 600 or more restrictive \\
    \hline
    1.2.1 & Warn  & Ensure that the --anonymous-auth argument is set to false \\
    \hline
    ... & & \\
    \hline
    \end{tabular}%
  \label{tab:rke2Scan}%
\end{table}%

On RKE2, we can see several failed tests that we will inspect more closely.

The detailed results from AKS are much more positive and include only warnings:
\pagebreak

% Table generated by Excel2LaTeX from sheet 'LaTeX'
\begin{table}[hp]
  \centering
  \caption{CIS Scans Results AKS (Excel2LaTeX)}
    \begin{tabular}{| l | l | p{11.6cm} |}
    \hline
    ID & State & Description \\
    \hline\hline
    3.1.1 & Warn  & Ensure that the kubeconfig file permissions are set to 644 or more restrictive \\
    \hline
    3.1.2 & Warn  & Ensure that the kubelet kubeconfig file ownership is set to root:root \\
    \hline
    3.1.3 & Warn  & Ensure that the kubelet configuration file has permissions set to 644 or more restrictive \\
    \hline
    3.1.4 & Warn  & Ensure that the kubelet configuration file ownership is set to root:root \\
    \hline
    3.2.11 & Warn  & Ensure that the RotateKubeletServerCertificate argument is set to true \\
    \hline
    3.2.1 & Pass  & Ensure that the --anonymous-auth argument is set to false \\
    \hline
    3.2.2 & Pass  & Ensure that the --authorization-mode argument is not set to AlwaysAllow \\
    \hline
    3.2.3 & Pass  & Ensure that the --client-ca-file argument is set as appropriate \\
    \hline
    3.2.4 & Pass  & Ensure that the --read-only-port argument is set to 0 \\
    \hline
    3.2.5 & Pass  & Ensure that the --streaming-connection-idle-timeout argument is not set to 0 \\
    \hline
    3.2.6 & Pass  & Ensure that the --protect-kernel-defaults argument is set to true \\
    \hline
    3.2.7 & Pass  & Ensure that the --make-iptables-util-chains argument is set to true \\
    \hline
    3.2.8 & Pass  & Ensure that the --hostname-override argument is not set \\
    \hline
    3.2.9 & Pass  & Ensure that the --event-qps argument is set to 0 or a level which ensures appropriate event capture \\
    \hline
    3.2.10 & Pass  & Ensure that the --rotate-certificates argument is not set to false \\
    \hline
    \end{tabular}%
  \label{tab:aksScan}%
\end{table}%

As we have seen before, CIS Benchmark test 3.2.1 for anonymous access to the Kubelet server is set to pass for the hosted Kubernetes version and is shown as a warning for the default installation of our RKE2 cluster. To support this test, the CIS Benchmark documentation states the obvious: "You should rely on authentication to authorize access and disallow anonymous requests."\footnote{\textit{CIS (2023)}: CIS AKS Benchmark, 3.2 Kubelet. \cite{cisAks}}

\subsection{Relevance for NIS2 Article 21}

The failing benchmark tests on our manually installed cluster are in CIS Benchmark sections 1.1—Control Plane Node Configuration Files, 1.2—API Server, and 3.2—Logging.

For the configuration file access permissions, the CIS Benchmark documentation states: "You should restrict its file permissions to maintain the file's integrity. The file should be writable by only the administrators on the system."\footnote{\textit{CIS (2023)}: CIS Kubernetes Benchmark, 1.1 Control Plane Node Configuration Files. \cite{cisK8s}} In the field of computer security, this is referred to as the Principle of Least Privilege. For configuration file access, it means that they should only be readable and writeable by their respective owner (file permissions 0600).

For the logging configuration, the CIS Benchmark recommends enabling audit logging for the Kubernetes control plane, at least with a minimal audit policy. Its rationale is: "Logging is an important detective control for all systems to detect potential unauthorized access."\footnote{\textit{CIS (2023)}: Ibid., 3.2 Logging. \cite{cisK8s}} Logging, especially when the data is stored on a separate system, is crucial for problem-solving, detecting attacks, and performing forensic analysis after an attack or breach.

The appropriate audit-log parameters need to be set to enable basic audit logging.\footnote{See \textit{CIS (2023)}: Ibid., 1.2 API Server. \cite{cisK8s}}

Restricting access to critical configuration files and enabling audit logging is part of basic cyber hygiene. It should be standard for all critical IT systems that follow established principles for good governance.

\subsection{Implications for DORA compliance}

To support DORA compliance, CIS Security released in April 2025 a mapping for the CIS Controls v8.1 and DORA.\footnote{\textit{CIS (2025)}: CIS Controls v8.1 Mapping to DORA. \cite{cisMapDora}}

\subsection{Overall Compliance and Risk Mitigation}

We have seen Microsoft's Azure Kubernetes Engine pass the CIS Benchmark. The other major hosted versions of Kubernetes, Google's Kubernetes Engine (GKE) and Amazon's Elastic Kubernetes Service (EKS), also offer CIS Compliance to their customers.

Other Kubernetes distributions, such as Red Hat's OpenShift, also offer CIS compliance. 

Ensuring that an IT system, such as a Kubernetes cluster, scores a passing grade on the CIS Benchmarks supports basic cyber hygiene and should be part of the IT Security Policy.

\subsection{Outlook}

Article 21 of the NIS 2 Directive outlines the cybersecurity risk-management measures essential entities must implement to protect their networks and information systems. These measures are designed to prevent and minimize the impact of cyber incidents on both the entities and their customers. It outlines critical cybersecurity practices that every business under the NIS2 regulations must have in place. 

One mandatory cybersecurity measure under Article 21 is basic cyber hygiene practices and training, as described in paragraph 2(g).

This requirement is where NIS2, the CIS Controls, and the CIS Benchmarks intersect. The CIS Benchmarks outline and implement procedures to fulfill CIS Control 04, Secure Configuration, a crucial requirement for basic cyber hygiene and part of any IT Security Policy.

As we've seen above, CIS Benchmarks can be used to enforce good security practices by automatically checking for deviations and issues. CIS Benchmarks can also recommend the necessary steps for remediation.

We can conclude that a passing result for the appropriate CIS Benchmark can serve as a good indicator of whether the Kubernetes cluster is NIS2 compliant.

Passing the CIS Benchmark alone is not a sufficient indicator, though, as the NIS2 Directive includes many more aspects than the basic cyber hygiene outlined in Article 21; however, failing the CIS Benchmark will be a clear indicator that the IT platform is not NIS2 compliant.

NIS2 is a legal framework, and compliance will be mandatory for European critical entities, ensuring widespread adoption. Unlike the CISecurity or ISO 27001 frameworks, adherence to the NIS2 Directive's requirements is not optional for entities classified as essential.

In addition to Article 21, the NIS2 Directive also contains Article 23, which outlines the requirements for EU-wide incident reporting. Article 23 defines what constitutes an incident, the mandatory reports, and the content required in these reports. With pan-European reporting of cyber attacks, a coordinated response should become much more manageable.
